withDatabaseConnection -> withDatabaseContext, per procedure-fns pattern
